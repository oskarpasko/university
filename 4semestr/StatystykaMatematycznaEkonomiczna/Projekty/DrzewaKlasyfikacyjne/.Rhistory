library(readxl)
library(MASS)
library(maptree)
library(rpart)
library(rpart.plot)
library(party)
install.packages("party")
install.packages("mvtnorm")
library(readxl)
library(MASS)
library(maptree)
library(rpart)
library(rpart.plot)
library(party)
library(class)
dane <- read_excel("data.xlsx")
head(data)
dane <- read_excel("data.xlsx")
head(dane)
raw_data <- data.frame(dane)
data <- na.omit(data.frame(raw_data))
head(data)
dane <- read_excel("data.xlsx")
head(dane)
raw_data <- data.frame(dane)
data <- na.omit(data.frame(raw_data))
head(data)
dane <- read_excel("data.xlsx")
raw_data <- data.frame(dane)
data <- na.omit(data.frame(raw_data))
head(data)
indexes <- sample(1:nrow(dane),nrow(dane)/2,replace = FALSE)
ZU = dane[indexes, ]
ZT = dane[-indexes, ]
head(ZU)
head(ZT)
drzewo <- rpart(ZU$`Approved Loan`~.,ZU,method = "class")
drzewo$parms
model.opt<-which.min(drzewo$cptable[,4])
Pred1<-predict(drzewo,ZU,type = "class")
Pred2<-predict(drzewo2,ZU,type = "class")
TPred1<-predict(drzewo,ZT,type = "class")
rpart.plot(drzewo,type = 4,extra="auto")
indexes <- sample(1:nrow(dane),nrow(dane)/2,replace = FALSE)
ZU = dane[indexes, ]
ZT = dane[-indexes, ]
head(ZU)
head(ZT)
drzewo <- rpart(ZU$`Approved Loan`~.,ZU,method = "class")
drzewo <- rpart(ZU$`Atrakcyjność`~.,ZU,method = "class")
drzewo <- rpart(ZU$`Atrakcyjność`~.,ZU,method = "class")
drzewo$parms
drzewo$numresp
drzewo$parms
drzewo$numresp
model.opt<-which.min(drzewo$cptable[,4])
cp.opt<-drzewo$cptable[model.opt,1]
drzewo2<-prune(drzewo,cp=model.opt)
Pred1<-predict(drzewo,ZU,type = "class")
print("tabela dobroci klasyfikacji")
table(predykacja=Pred1,prawdziwe=ZU$`Approved Loan`)
Pred1<-predict(drzewo,ZU,type = "class")
print("tabela dobroci klasyfikacji")
table(predykacja=Pred1,prawdziwe=ZU$`Atrakcyjność`)
print("obliczanie błędu predykcji")
blad1<-mean(Pred1 != ZU$`Atrakcyjność`)
blad1
Pred2<-predict(drzewo2,ZU,type = "class")
print("tabela dobroci klasyfikacji")
table(predykacja=Pred2,prawdziwe=ZU$`Atrakcyjność`)
print("obliczanie błędu predykcji")
blad2<-mean(Pred2 != ZU$`Atrakcyjność`)
blad2
TPred1<-predict(drzewo,ZT,type = "class")
bladT1<-mean(TPred1 != ZT$`Atrakcyjność`)
print("Błąd predykcji drzewa")
bladT1
TPred2<-predict(drzewo2,ZT,type = "class")
bladT2<-mean(TPred2 != ZT$`Atrakcyjność`)
print("Błąd predykcji drzewa Przyciętego")
bladT2
TPred1<-predict(drzewo,ZT,type = "class")
bladT1<-mean(TPred1 != ZT$`Atrakcyjność`)
print("Błąd predykcji drzewa")
bladT1
TPred2<-predict(drzewo2,ZT,type = "class")
bladT2<-mean(TPred2 != ZT$`Atrakcyjność`)
print("Błąd predykcji przyciętego drzewa")
bladT2
rpart.plot(drzewo,type = 4,extra="auto")
rpart.plot(drzewo2,type = 4,extra="auto")
